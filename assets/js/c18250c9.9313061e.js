"use strict";(self.webpackChunkintellisense_form_docs=self.webpackChunkintellisense_form_docs||[]).push([[6316],{3905:function(t,e,n){n.d(e,{Zo:function(){return u},kt:function(){return d}});var r=n(67294);function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function o(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},l=Object.keys(t);for(r=0;r<l.length;r++)n=l[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(r=0;r<l.length;r++)n=l[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}var p=r.createContext({}),s=function(t){var e=r.useContext(p),n=e;return t&&(n="function"==typeof t?t(e):a(a({},e),t)),n},u=function(t){var e=s(t.components);return r.createElement(p.Provider,{value:e},t.children)},m={inlineCode:"code",wrapper:function(t){var e=t.children;return r.createElement(r.Fragment,{},e)}},c=r.forwardRef((function(t,e){var n=t.components,i=t.mdxType,l=t.originalType,p=t.parentName,u=o(t,["components","mdxType","originalType","parentName"]),c=s(n),d=i,g=c["".concat(p,".").concat(d)]||c[d]||m[d]||l;return n?r.createElement(g,a(a({ref:e},u),{},{components:n})):r.createElement(g,a({ref:e},u))}));function d(t,e){var n=arguments,i=e&&e.mdxType;if("string"==typeof t||i){var l=n.length,a=new Array(l);a[0]=c;var o={};for(var p in e)hasOwnProperty.call(e,p)&&(o[p]=e[p]);o.originalType=t,o.mdxType="string"==typeof t?t:i,a[1]=o;for(var s=2;s<l;s++)a[s]=n[s];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}c.displayName="MDXCreateElement"},78872:function(t,e,n){n.r(e),n.d(e,{frontMatter:function(){return o},contentTitle:function(){return p},metadata:function(){return s},toc:function(){return u},default:function(){return c}});var r=n(87462),i=n(63366),l=(n(67294),n(3905)),a=["components"],o={id:"guide-list-page-config",title:"列表页按钮定制"},p=void 0,s={unversionedId:"guide-list-page-config",id:"guide-list-page-config",title:"列表页按钮定制",description:"目前系统中的列表类型：",source:"@site/docs/guide-list-page-config.mdx",sourceDirName:".",slug:"/guide-list-page-config",permalink:"/intellisense-form-website/docs/guide-list-page-config",tags:[],version:"current",frontMatter:{id:"guide-list-page-config",title:"列表页按钮定制"},sidebar:"someSidebar",previous:{title:"定制表单样式",permalink:"/intellisense-form-website/docs/guide-form-style"},next:{title:"列表按钮点击前置事件定制",permalink:"/intellisense-form-website/docs/guide-list-button-before-click"}},u=[{value:"如何在插件项目中使用",id:"如何在插件项目中使用",children:[{value:"页面级别的按钮",id:"页面级别的按钮",children:[],level:3},{value:"列表支持选中",id:"列表支持选中",children:[],level:3},{value:"单行数据级别的按钮",id:"单行数据级别的按钮",children:[],level:3},{value:"内置行内按钮可见性控制",id:"内置行内按钮可见性控制",children:[],level:3}],level:2}],m={toc:u};function c(t){var e=t.components,n=(0,i.Z)(t,a);return(0,l.kt)("wrapper",(0,r.Z)({},m,n,{components:e,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"目前系统中的列表类型："),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"草稿列表"),(0,l.kt)("li",{parentName:"ul"},"待办列表"),(0,l.kt)("li",{parentName:"ul"},"已办列表"),(0,l.kt)("li",{parentName:"ul"},"查询列表"),(0,l.kt)("li",{parentName:"ul"},"无流程列表")),(0,l.kt)("p",null,"我们可以通过列表页定制做到："),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"在列表外添加自定义的按钮，我们可以把它定义为页面级别的按钮"),(0,l.kt)("li",{parentName:"ul"},"定义列表数据是否支持复选框选中"),(0,l.kt)("li",{parentName:"ul"},"定义每条数据对应的操作按钮，我们把它定义为单行数据级别的按钮")),(0,l.kt)("h2",{id:"如何在插件项目中使用"},"如何在插件项目中使用"),(0,l.kt)("h3",{id:"页面级别的按钮"},"页面级别的按钮"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"创建自定义的按钮组件")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="src/plugins/list-page-button-query/CustomQueryButton.ts"',title:'"src/plugins/list-page-button-query/CustomQueryButton.ts"'},"import $ from 'jQuery';\nimport { SinoFormElement } from '@sinoform/plugin-sinoform-helpers';\nimport './style.css';\n\nexport default class CustomQueryButton extends SinoFormElement {\n  onClick() {\n    console.log('按钮被点击了');\n  }\n\n  override render() {\n    this.innerHTML = `<button class=\"custom-button\">列表按钮</button>`;\n\n    $('.custom-button', this).on('click', this.onClick.bind(this));\n  }\n}\n")),(0,l.kt)("p",null,"组件样式："),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-css",metastring:'title="src/plugins/list-page-button-query/style.css"',title:'"src/plugins/list-page-button-query/style.css"'},".custom-button {\n  color: #fff;\n  background-color: #2196f3;\n  font-size: 0.875rem;\n  border: none;\n  height: 36px;\n  margin: 8px;\n}\n")),(0,l.kt)("ol",{start:2},(0,l.kt)("li",{parentName:"ol"},"包装为 React 组件")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="src/plugins/list-page-button-query/index.ts"',title:'"src/plugins/list-page-button-query/index.ts"'},"import { wrapperWebComponent } from '@sinoform/plugin-sinoform-helpers';\nimport CustomQueryButton from './CustomQueryButton';\n\nexport default wrapperWebComponent('list-page-button-query', CustomQueryButton);\n")),(0,l.kt)("ol",{start:3},(0,l.kt)("li",{parentName:"ol"},"注册到智能表单")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="src/index.ts"',title:'"src/index.ts"'},"import AppSetting from '@sinoform/app-setting';\n\nAppSetting.listPageConfig.addButton({\n  type: 'ALL_PAGE',\n  render: React.lazy(() => import('./plugins/list-page-button-query')),\n  formId: '*',\n  pos: 'left',\n  availability: (id, type, currentUser, formDesignSetting) => {\n    return !(\n      id === '123456' &&\n      type === 'SEARCH_LIST_PAGE' &&\n      currentUser.userId === 'xxx'\n    );\n  },\n});\n")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"addButton")," 参数的说明"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"type: 按钮需要在哪一类列表页中展示，支持的类型如下",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"DRAFT_LIST_PAGE: 草稿列表"),(0,l.kt)("li",{parentName:"ul"},"TODO_LIST_PAGE: 待办列表"),(0,l.kt)("li",{parentName:"ul"},"DONE_LIST_PAGE: 已办列表"),(0,l.kt)("li",{parentName:"ul"},"SEARCH_LIST_PAGE: 查询列表"),(0,l.kt)("li",{parentName:"ul"},"NOFLOW_LIST_PAGE: 无流程列表"),(0,l.kt)("li",{parentName:"ul"},"ALL_PAGE: 所有列表都支持"),(0,l.kt)("li",{parentName:"ul"},"其他。定制列表配置中的页面类型"))),(0,l.kt)("li",{parentName:"ul"},"render: 按钮的渲染组件"),(0,l.kt)("li",{parentName:"ul"},"formId: 表单设计 id，用于控制按钮需要在哪个表单的列表界面展示，如果为","*","，则所有的表单都适用"),(0,l.kt)("li",{parentName:"ul"},"pos: 可取值 left 、right，默认 right。用于控制按钮居左还是居右显示"),(0,l.kt)("li",{parentName:"ul"},"order: 按钮的排序，数值越大显示越靠前。默认值为 0"),(0,l.kt)("li",{parentName:"ul"},"availability: 按钮是否显示的回调函数，返回值为 true，展示按钮，反之则不展示。函数的参数说明如下：",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"id。表单设计 id"),(0,l.kt)("li",{parentName:"ul"},"type。表单类型"),(0,l.kt)("li",{parentName:"ul"},"currentUser。当前登录人"),(0,l.kt)("li",{parentName:"ul"},"formDesignSetting。表单设计配置数据")))),(0,l.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"上述代码含义解读：除了登录用户 id 为 ",(0,l.kt)("inlineCode",{parentName:"p"},"xxx")," ，表单 id 为 ",(0,l.kt)("inlineCode",{parentName:"p"},"123456")," 的查询列表界面，其余所有用户的所有列表的定制按钮区域左侧添加一个自定义按钮。"))),(0,l.kt)("p",null,"最后可以在演示系统中查看效果。点击新的按钮，会在控制台输出 ",(0,l.kt)("inlineCode",{parentName:"p"},"按钮被点击了"),"。"),(0,l.kt)("p",null,"列表级的按钮接收下面这些属性参数"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"formId: 表单的设计 id"),(0,l.kt)("li",{parentName:"ul"},"currentUser: 当前登录人信息"),(0,l.kt)("li",{parentName:"ul"},"formDesignSetting: 表单设计信息"),(0,l.kt)("li",{parentName:"ul"},"dataSource: 分页查询的操作对象"),(0,l.kt)("li",{parentName:"ul"},"url: 列表页查询接口")),(0,l.kt)("p",null,"接下来，我们以 dataSource 为例，通过 dataSource 来执行列表刷新"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="src/plugins/list-page-button-query/CustomQueryButton.ts"',title:'"src/plugins/list-page-button-query/CustomQueryButton.ts"'},"onClick(){\n  const { dataSource } = this.props;\n  dataSource.reload();\n}\n")),(0,l.kt)("h3",{id:"列表支持选中"},"列表支持选中"),(0,l.kt)("p",null,"示例中我们简化处理，直接在插件入口文件中定义"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="src/index.ts"',title:'"src/index.ts"'},"appSetting.listPageConfig.addSelectable({\n  type: 'ALL_PAGE',\n  formId: '*',\n});\n")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"addSelectable")," 方法参数中 ",(0,l.kt)("inlineCode",{parentName:"p"},"type")," 和 ",(0,l.kt)("inlineCode",{parentName:"p"},"formId")," 的定义与 ",(0,l.kt)("inlineCode",{parentName:"p"},"addButton")," 方法相同"),(0,l.kt)("h3",{id:"单行数据级别的按钮"},"单行数据级别的按钮"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"创建自定义的按钮组件")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="src/plugins/list-page-button-in-row/InRowButton.ts"',title:'"src/plugins/list-page-button-in-row/InRowButton.ts"'},"import $ from 'jQuery';\nimport { SinoFormElement } from '@sinoform/plugin-sinoform-helpers';\nimport './style.css';\n\nexport default class InRowButton extends SinoFormElement {\n  onClick() {\n    console.log('按钮被点击了');\n  }\n\n  override render() {\n    this.innerHTML = `<button class=\"custom-button\">行内按钮</button>`;\n\n    $('.custom-button', this).on('click', this.onClick.bind(this));\n  }\n}\n")),(0,l.kt)("p",null,"组件样式："),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-css",metastring:'title="src/plugins/list-page-button-in-row/style.css"',title:'"src/plugins/list-page-button-in-row/style.css"'},".custom-button {\n  color: #fff;\n  background-color: #2196f3;\n  font-size: 0.875rem;\n  border: none;\n  height: 36px;\n  margin: 8px;\n}\n")),(0,l.kt)("ol",{start:2},(0,l.kt)("li",{parentName:"ol"},"包装为 React 组件")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="src/plugins/list-page-button-in-row/index.ts"',title:'"src/plugins/list-page-button-in-row/index.ts"'},"import { wrapperWebComponent } from '@sinoform/plugin-sinoform-helpers';\nimport InRowButton from './InRowButton';\n\nexport default wrapperWebComponent('list-page-button-in-row', InRowButton);\n")),(0,l.kt)("ol",{start:3},(0,l.kt)("li",{parentName:"ol"},"注册到智能表单")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="src/index.ts"',title:'"src/index.ts"'},"import AppSetting from '@sinoform/app-setting';\n\nAppSetting.listPageConfig.addInRowButton({\n  type: 'ALL_PAGE',\n  render: React.lazy(() => import('./plugins/list-page-button-in-row')),\n  formId: '*',\n});\n")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"addInRowButton"),"中参数的定义与",(0,l.kt)("inlineCode",{parentName:"p"},"addButton"),"方法一致"),(0,l.kt)("p",null,"单行数据级别的按钮支持如下参数"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"rowData: 当前行对应的数据"),(0,l.kt)("li",{parentName:"ul"},"dataSource: 分页查询的操作对象")),(0,l.kt)("p",null,"完善行内按钮的点击事件，打印当前行数据"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="src/plugins/list-page-button-in-row/InRowButton.ts"',title:'"src/plugins/list-page-button-in-row/InRowButton.ts"'},"onClick() {\n  const { rowData } = this.props;\n  console.log(rowData);\n}\n")),(0,l.kt)("h3",{id:"内置行内按钮可见性控制"},"内置行内按钮可见性控制"),(0,l.kt)("p",null,"除了可以新增行内按钮之外，我们也可以定制已有的行内按钮的可见性。"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="src/index.ts"',title:'"src/index.ts"'},"appSetting.listPageConfig.setInRowButtonVisible(\n  '*',\n  'NOFLOW_LIST_PAGE',\n  'deleteButton',\n  (currentUser, formDesignSetting, rowData) => {\n    if (rowData?.isPublish === '已发布') {\n      return false;\n    }\n\n    return true;\n  }\n);\n")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"setInRowButtonVisible")," 参数的说明:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"formId。表单 id 或表单 id 数组。",(0,l.kt)("inlineCode",{parentName:"li"},"*"),"标识匹配任意表单 id"),(0,l.kt)("li",{parentName:"ul"},"pageType。页面类型"),(0,l.kt)("li",{parentName:"ul"},"buttonName。按钮名称。内置按钮名称说明：",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"deleteButton。删除按钮"),(0,l.kt)("li",{parentName:"ul"},"copyButton。复用按钮"),(0,l.kt)("li",{parentName:"ul"},"editButton。编辑按钮"),(0,l.kt)("li",{parentName:"ul"},"viewButton。查看按钮"))),(0,l.kt)("li",{parentName:"ul"},"visible。按钮是否显示回调函数，返回 true，按钮显示，反之则不显示。参数说明：",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"currentUser。当前登录人"),(0,l.kt)("li",{parentName:"ul"},"formDesignSetting。表单设计配置数据"),(0,l.kt)("li",{parentName:"ul"},"rowData。当前行数据")))),(0,l.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"上述代码含义解读：任意无流程列表中，如果某行数据中的",(0,l.kt)("inlineCode",{parentName:"p"},"isPublish"),"字段值为",(0,l.kt)("inlineCode",{parentName:"p"},"已发布"),"，则该行操作列中的删除按钮不显示。"))))}c.isMDXComponent=!0}}]);