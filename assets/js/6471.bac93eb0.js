"use strict";(self.webpackChunkintellisense_form_docs=self.webpackChunkintellisense_form_docs||[]).push([[6471],{46471:function(e,n,r){r.r(n),r.d(n,{default:function(){return O}});var t=r(67294),a=r(17346),l=r(8901),i=r(23500),o=r(85032),s=r(72752),m=r(66919),u=r(74165),c=r(15861),d=r(4256);function f(){return p.apply(this,arguments)}function p(){return(p=(0,c.Z)((0,u.Z)().mark((function e(){var n,t,a,l;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(3945).then(r.t.bind(r,73945,23));case 2:return n=e.sent,t=n.default,e.next=6,r.e(893).then(r.t.bind(r,70893,23));case 6:return a=e.sent,l=a.default,e.abrupt("return",{prettier:t,yamlParser:l});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var b={mysql:"com.mysql.cj.jdbc.Driver",oracle:"oracle.jdbc.driver.OracleDriver",dm:"dm.jdbc.driver.DmDriver",kingbase:"com.kingbase.Driver"},v={mysql:"select 1",oracle:"select 1 from dual",dm:"select 1 from dual",kingbase:"select 1 from dual"},g=function(){var e=(0,c.Z)((0,u.Z)().mark((function e(n){var t,a,l,i,o,s,m,c,p,g,x,E,y,S,w,h,k,Z,C,U,D,q,j,T,z;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w=n.values,n.validate(),n.isValid){e.next=6;break}return d.Z.error("单点登录链接填写不正确，请修改后重试"),e.abrupt("return");case 6:return e.next=8,f();case 8:return h=e.sent,k=h.prettier,Z=h.yamlParser,C=k.format("\n  # 自定义项目使用的端口号\n  server:\n    port: "+w.port+"\n\n  # 数据库类型\n  database:\n    type: "+("mysql"===w.db.type?"mysql":"oracle")+"\n  ",{filepath:"applicaiton.yml",parser:"yaml",plugins:[Z]}),U=k.format("\n  spring:\n    data:\n      mongodb:\n        uri: "+(u=w.mongodb,M=void 0,A=void 0,L=void 0,F=void 0,O=void 0,P=void 0,M=u.port,A=void 0===M?"27017":M,L=u.username,F=void 0===L?"":L,O=u.password,P=void 0===O?"":O,"mongodb://"+(F&&P?F+":"+P+"@":"")+u.host+":"+A+"/form\n    datasource:\n      url: ")+(null!=(t=w.db.url)?t:"")+"\n      username: "+(null!=(a=w.db.username)?a:"")+"\n      password: "+(null!=(l=w.db.password)?l:"")+"\n      driver-class-name: "+b[w.db.type]+"\n      druid:\n        # 指定测试数据库连接的连通性 SQL 语句\n        validation-query: "+v[w.db.type]+"\n\n  # 指定单点登录服务链接\n  sso:\n    ssoService: "+(null!=(i=w.sinomatrix.ssoServerUrl)?i:"")+"\n  \n  sinoform:\n    # 指定工作流设计器服务链接\n    workflow-design-server-uri: "+(null!=(o=w.sinomatrix.workflowDesignServerUri)?o:"")+"\n    # 指定工作流引擎链接\n    workflow-server-uri: "+(null!=(s=w.sinomatrix.workflowServerUri)?s:"")+"\n    # 指定统一授权服务链接\n    uias-server-uri: "+(null!=(m=w.sinomatrix.uiasServerUri)?m:"")+"\n  \n  sinomatrix:\n    # 指定sinomatrix数据源配置\n    datasource:\n      url: "+(null!=(c=w.sinomatrix.dataSourceConfig.url)?c:"")+"\n      username: "+(null!=(p=w.sinomatrix.dataSourceConfig.username)?p:"")+"\n      password: "+(null!=(g=w.sinomatrix.dataSourceConfig.password)?g:"")+"\n      driver-class-name: "+b[w.db.type]+"\n      type: com.alibaba.druid.pool.DruidDataSource\n      druid:\n        # 初始化连接数\n        initial-size: "+(null!=(x=w.sinomatrix.dataSourceConfig.initialSize)?x:1)+"\n        # 最小连接池数量\n        # spring.datasource.druid\n        min-idle: "+(null!=(E=w.sinomatrix.dataSourceConfig.minIdle)?E:1)+"\n        # 最大连接池数量\n        max-active: "+(null!=(y=w.sinomatrix.dataSourceConfig.maxActive)?y:20)+"\n        # 获取连接时最大等待时间，单位毫秒\n        max-wait: "+(null!=(S=w.sinomatrix.dataSourceConfig.maxWait)?S:6e4)+"\n  ",{filepath:"application-dev.yml",parser:"yaml",plugins:[Z]}),e.next=15,r.e(5733).then(r.t.bind(r,55733,23));case 15:return D=e.sent,q=D.default,(j=new q).file("application.yml",C),j.file("application-dev.yml",U),j.file("application-test.yml",U),j.file("application-prod.yml",U),e.next=24,j.generateAsync({type:"blob"});case 24:return T=e.sent,e.next=27,r.e(3162).then(r.t.bind(r,93162,23));case 27:z=e.sent,(0,z.default.saveAs)(T,"config.zip");case 30:case"end":return e.stop()}var u,M,A,L,F,O,P}),e)})));return function(n){return e.apply(this,arguments)}}(),x=g,E=r(87462),y=r(49658),S=r(68307),w={cursor:"pointer"};var h=function(e){var n=(0,t.useState)("text"),r=n[0],l=n[1],i="password"===r;return t.createElement(a.default,(0,E.Z)({},e,{type:r,endAdornment:t.createElement(y.default,{position:"end",style:w},i?t.createElement(S.wqE,{onClick:function(){return l("text")},onMouseDown:function(e){return e.preventDefault()}}):t.createElement(S.t2l,{onClick:function(){return l("password")},onMouseDown:function(e){return e.preventDefault()}}))}))},k=r(15762),Z={k8s:{namespace:"default"},port:8085,db:{type:"mysql",url:"jdbc:mysql://127.0.0.1:3306/form?serverTimezone=UTC&useUnicode=true&characterEncoding=UTF-8&allowMultiQueries=true&useSSL=false",username:"root",password:"12345678"},mongodb:{host:"127.0.0.1",port:27017},sinomatrix:{ssoServerUrl:"http://127.0.0.1:18880/sso",workflowDesignServerUri:"127.0.0.1:8088",workflowServerUri:"127.0.0.1:18003",uiasServerUri:"127.0.0.1:18001",dataSourceConfig:{type:"mysql",url:"jdbc:mysql://127.0.0.1:3306/sinoepuias?serverTimezone=UTC&useUnicode=true&characterEncoding=UTF-8&allowMultiQueries=true&useSSL=false&allowPublicKeyRetrieval=true",username:"sinoepuias",password:"sinoepuias",initialSize:1,minIdle:1,maxActive:20,maxWait:6e4}}};var C=function(){return(0,k.Z)("BACKEND_CONFIG",Z)},U=r(87501);function D(e){if(!e.startsWith("http://")&&!e.startsWith("https://")||-1===e.indexOf("/sso"))return"链接地址不正确"}function q(){return j.apply(this,arguments)}function j(){return(j=(0,c.Z)((0,u.Z)().mark((function e(){var n,t,a,l;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(3945).then(r.t.bind(r,73945,23));case 2:return n=e.sent,t=n.default,e.next=6,r.e(893).then(r.t.bind(r,70893,23));case 6:return a=e.sent,l=a.default,e.abrupt("return",{prettier:t,yamlParser:l});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var T={mysql:"com.mysql.cj.jdbc.Driver",oracle:"oracle.jdbc.driver.OracleDriver",dm:"dm.jdbc.driver.DmDriver",kingbase:"com.kingbase.Driver"},z={mysql:"select 1",oracle:"select 1 from dual",dm:"select 1 from dual",kingbase:"select 1 from dual"},M=function(){var e=(0,c.Z)((0,u.Z)().mark((function e(n){var t,a,l,i,o,s,m,c,f,p,b,v,g,x,E,y,S,w,h,k,Z;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(E=n.values,n.validate(),n.isValid){e.next=6;break}return d.Z.error("单点登录链接填写不正确，请修改后重试"),e.abrupt("return");case 6:return e.next=8,q();case 8:return y=e.sent,S=y.prettier,w=y.yamlParser,h=S.format("\n  apiVersion: v1\n  kind: ConfigMap\n  metadata:\n    name: sinoform-backend-config\n    namespace: "+(E.k8s.namespace?E.k8s.namespace:"default")+"\n  data:\n    application.yaml: |\n      spring:\n        data:\n          mongodb:\n            uri: "+(u=E.mongodb,C=void 0,U=void 0,D=void 0,j=void 0,M=void 0,A=void 0,C=u.port,U=void 0===C?"27017":C,D=u.username,j=void 0===D?"":D,M=u.password,A=void 0===M?"":M,"mongodb://"+(j&&A?j+":"+A+"@":"")+u.host+":"+U+"/form\n        datasource:\n          url: ")+(null!=(t=E.db.url)?t:"")+"\n          username: "+(null!=(a=E.db.username)?a:"")+"\n          password: "+(null!=(l=E.db.password)?l:"")+"\n          driver-class-name: "+T[E.db.type]+"\n          druid:\n            # 指定测试数据库连接的连通性 SQL 语句\n            validation-query: "+z[E.db.type]+"\n\n      # 指定单点登录服务链接\n      sso:\n        ssoService: "+(null!=(i=E.sinomatrix.ssoServerUrl)?i:"")+"\n      \n      sinoform:\n        # 指定工作流设计器服务链接\n        workflow-design-server-uri: "+(null!=(o=E.sinomatrix.workflowDesignServerUri)?o:"")+"\n        # 指定工作流引擎链接\n        workflow-server-uri: "+(null!=(s=E.sinomatrix.workflowServerUri)?s:"")+"\n        # 指定统一授权服务链接\n        uias-server-uri: "+(null!=(m=E.sinomatrix.uiasServerUri)?m:"")+"\n      \n      sinomatrix:\n        # 指定sinomatrix数据源配置\n        datasource:\n          url: "+(null!=(c=E.sinomatrix.dataSourceConfig.url)?c:"")+"\n          username: "+(null!=(f=E.sinomatrix.dataSourceConfig.username)?f:"")+"\n          password: "+(null!=(p=E.sinomatrix.dataSourceConfig.password)?p:"")+"\n          driver-class-name: "+T[E.db.type]+"\n          type: com.alibaba.druid.pool.DruidDataSource\n          druid:\n            # 初始化连接数\n            initial-size: "+(null!=(b=E.sinomatrix.dataSourceConfig.initialSize)?b:1)+"\n            # 最小连接池数量\n            # spring.datasource.druid\n            min-idle: "+(null!=(v=E.sinomatrix.dataSourceConfig.minIdle)?v:1)+"\n            # 最大连接池数量\n            max-active: "+(null!=(g=E.sinomatrix.dataSourceConfig.maxActive)?g:20)+"\n            # 获取连接时最大等待时间，单位毫秒\n            max-wait: "+(null!=(x=E.sinomatrix.dataSourceConfig.maxWait)?x:6e4)+"\n  ",{filepath:"sinoform-backend-config.yaml",parser:"yaml",plugins:[w]}),k=new Blob([h]),e.next=15,r.e(3162).then(r.t.bind(r,93162,23));case 15:Z=e.sent,(0,Z.default.saveAs)(k,"sinoform-backend-config.yaml");case 18:case"end":return e.stop()}var u,C,U,D,j,M,A}),e)})));return function(n){return e.apply(this,arguments)}}(),A=M,L={mysql:"jdbc:mysql://127.0.0.1:3306/form?serverTimezone=UTC&useUnicode=true&characterEncoding=UTF-8&allowMultiQueries=true&useSSL=false",oracle:"jdbc:oracle:thin:@127.0.0.1:1521/form",kingbase:"jdbc:kingbase://127.0.0.1:54323/form",dm:"jdbc:dm://127.0.0.1:5236"},F={mysql:"jdbc:mysql://127.0.0.1:3306/sinoepuias?serverTimezone=UTC&useUnicode=true&characterEncoding=UTF-8&allowMultiQueries=true&useSSL=false&allowPublicKeyRetrieval=true",oracle:"jdbc:oracle:thin:@127.0.0.1:1521/sinoepuias",kingbase:"jdbc:kingbase://127.0.0.1:54323/sinoepuias",dm:"jdbc:dm://127.0.0.1:5236"},O=function(e){var n=e.type,r=C();(0,t.useState)((function(){r.addRelyRule(["db.type","sinomatrix.dataSourceConfig.type"],(function(e){e.db.url=L[e.db.type],e.sinomatrix.dataSourceConfig.url=F[e.sinomatrix.dataSourceConfig.type]}))}),[r]);return t.createElement("div",{className:"config-tools"},t.createElement(i.Z,{variant:"outlined",labelLayout:"floating",formState:r},"k8s"===n?t.createElement(t.Fragment,null,t.createElement("h4",null,"Kubernetes配置"),t.createElement(s.X2,{gutter:8},t.createElement(s.sg,{md:24,xs:24},t.createElement(o.Z,{name:"k8s.namespace",label:"命名空间"},t.createElement(a.default,null))))):null,t.createElement("h4",null,"应用配置"),t.createElement(U.FormValueMonitor,null,(function(e){return"8085"!==e.port?t.createElement(o.Z,{name:"port",label:"智能表单应用端口号"},t.createElement(a.default,{type:"number",helperText:"此端口需要与nginx配置中的sinoform_web_app端口保持一致"})):t.createElement(o.Z,{name:"port",label:"智能表单应用端口号"},t.createElement(a.default,{type:"number"}))})),t.createElement("h4",null,"关系型数据库配置"),t.createElement(s.X2,{gutter:8},t.createElement(s.sg,{md:6,xs:24},t.createElement(o.Z,{name:"db.type",label:"数据库类型"},t.createElement(l.ZP,{allowClear:!1},t.createElement("option",{value:"mysql"},"MySQL"),t.createElement("option",{value:"oracle"},"Oracle"),t.createElement("option",{value:"kingbase"},"人大金仓"),t.createElement("option",{value:"dm"},"达梦")))),t.createElement(s.sg,{md:18,xs:24},t.createElement(o.Z,{name:"db.url",label:"数据库链接"},t.createElement(a.default,{helperText:"建议智能表单和业务系统使用同一个数据库，示例中给出的数据库form 如果不存在，可以换成业务系统数据库，或者创建一个新的form "}))),t.createElement(s.sg,{md:12,xs:24},t.createElement(o.Z,{name:"db.username",label:"数据库用户名"},t.createElement(a.default,null))),t.createElement(s.sg,{md:12,xs:24},t.createElement(o.Z,{name:"db.password",label:"数据库密码"},t.createElement(h,null)))),t.createElement("h4",null,"sinomatrix数据库数据源配置"),t.createElement(s.X2,{gutter:8},t.createElement(s.sg,{md:6,xs:24},t.createElement(o.Z,{name:"sinomatrix.dataSourceConfig.type",label:"数据库类型"},t.createElement(l.ZP,{allowClear:!1},t.createElement("option",{value:"mysql"},"MySQL"),t.createElement("option",{value:"oracle"},"Oracle"),t.createElement("option",{value:"kingbase"},"人大金仓"),t.createElement("option",{value:"dm"},"达梦")))),t.createElement(s.sg,{md:18,sm:18,xs:24},t.createElement(o.Z,{name:"sinomatrix.dataSourceConfig.url",label:"数据源地址"},t.createElement(a.default,null))),t.createElement(s.sg,{md:12,xs:24},t.createElement(o.Z,{name:"sinomatrix.dataSourceConfig.username",label:"数据库用户名"},t.createElement(a.default,null))),t.createElement(s.sg,{md:12,xs:24},t.createElement(o.Z,{name:"sinomatrix.dataSourceConfig.password",label:"数据库密码"},t.createElement(h,null))),t.createElement(s.sg,{md:6,sm:12,xs:24},t.createElement(o.Z,{name:"sinomatrix.dataSourceConfig.initialSize",label:"初始连接数"},t.createElement(a.default,{type:"number"}))),t.createElement(s.sg,{md:6,sm:12,xs:24},t.createElement(o.Z,{name:"sinomatrix.dataSourceConfig.minIdle",label:"最小连接池数量"},t.createElement(a.default,{type:"number"}))),t.createElement(s.sg,{md:6,sm:12,xs:24},t.createElement(o.Z,{name:"sinomatrix.dataSourceConfig.maxActive",label:"最大连接池数量"},t.createElement(a.default,{type:"number"}))),t.createElement(s.sg,{md:6,sm:12,xs:24},t.createElement(o.Z,{name:"sinomatrix.dataSourceConfig.maxWait",label:"获取连接时最大等待时间"},t.createElement(a.default,{type:"number",helperText:"单位毫秒"})))),t.createElement("h4",null,"mongodb 数据库配置"),t.createElement(s.X2,{gutter:8},t.createElement(s.sg,{md:6,sm:12,xs:24},t.createElement(o.Z,{name:"mongodb.host",label:"mongodb 地址"},t.createElement(a.default,null))),t.createElement(s.sg,{md:6,sm:12,xs:24},t.createElement(o.Z,{name:"mongodb.port",label:"mongodb 端口号"},t.createElement(a.default,{type:"number"}))),t.createElement(s.sg,{md:6,sm:12,xs:24},t.createElement(o.Z,{name:"mongodb.username",label:"mongodb 用户名"},t.createElement(a.default,{placeholder:"用户名可以为空"}))),t.createElement(s.sg,{md:6,sm:12,xs:24},t.createElement(o.Z,{name:"mongodb.password",label:"mongodb 密码"},t.createElement(h,{placeholder:"密码可以为空"})))),t.createElement("h4",null,"sinomatrix 集成配置"),t.createElement(s.X2,{gutter:8},t.createElement(s.sg,{md:6,sm:12,xs:24},t.createElement(o.Z,{name:"sinomatrix.ssoServerUrl",label:"单点登录链接",validate:D},t.createElement(a.default,{placeholder:Z.sinomatrix.ssoServerUrl}))),t.createElement(s.sg,{md:6,sm:12,xs:24},t.createElement(o.Z,{name:"sinomatrix.workflowDesignServerUri",label:"工作流设计器服务"},t.createElement(a.default,{placeholder:Z.sinomatrix.workflowDesignServerUri}))),t.createElement(s.sg,{md:6,sm:12,xs:24},t.createElement(o.Z,{name:"sinomatrix.workflowServerUri",label:"工作流服务"},t.createElement(a.default,{placeholder:Z.sinomatrix.workflowServerUri}))),t.createElement(s.sg,{md:6,sm:12,xs:24},t.createElement(o.Z,{name:"sinomatrix.uiasServerUri",label:"uias服务"},t.createElement(a.default,{placeholder:Z.sinomatrix.uiasServerUri}))))),t.createElement(m.Z,{raised:!0,onClick:function(){"k8s"===n?A(r):x(r)}},"生成配置文件"))}},15762:function(e,n,r){r.d(n,{Z:function(){return m}});var t=r(87501),a=r(9996),l=r.n(a),i=r(67294),o=r(42965),s="undefined"==typeof window;function m(e,n){var r=(0,i.useState)((function(){var r;return null!=(r=function(e,n){if(s)return null;var r=localStorage[e];if(null!=r)try{var t=JSON.parse(r);return l()(n,t)}catch(e){return}}(e,n))?r:n}))[0],a=(0,t.useFormState)(r);return(0,i.useEffect)((function(){var n=function(e){return function(n){var r=JSON.stringify(n);localStorage[e]=r}}(e),r=a.values$.pipe((0,o.b)(200)).subscribe(n);return function(){return r.unsubscribe()}}),[e]),a}}}]);