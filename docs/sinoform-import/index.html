<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<title data-react-helmet="true">ä¸šåŠ¡æ•°æ®å¯¼å…¥ | intellisense-form</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://sinoui.github.io/intellisense-form-website/docs/sinoform-import"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="ä¸šåŠ¡æ•°æ®å¯¼å…¥ | intellisense-form"><meta data-react-helmet="true" name="description" content="ä¸šåŠ¡æ•°æ®å¯¼å…¥åŠŸèƒ½æ˜¯é€šè¿‡è¯»å– excel æ–‡ä»¶æ¥æ‰¹é‡ç”Ÿæˆæˆ–æ›´æ–°è¡¨å•æ•°æ®ã€‚@sinoform/helper-import-excelæ¨¡å—æä¾›äº†ä¸€æ•´å¥— excel è§£æã€æ•°æ®å¤„ç†ã€ä¸šåŠ¡æ•°æ®å¯¼å…¥çš„åŠŸèƒ½ã€‚"><meta data-react-helmet="true" property="og:description" content="ä¸šåŠ¡æ•°æ®å¯¼å…¥åŠŸèƒ½æ˜¯é€šè¿‡è¯»å– excel æ–‡ä»¶æ¥æ‰¹é‡ç”Ÿæˆæˆ–æ›´æ–°è¡¨å•æ•°æ®ã€‚@sinoform/helper-import-excelæ¨¡å—æä¾›äº†ä¸€æ•´å¥— excel è§£æã€æ•°æ®å¤„ç†ã€ä¸šåŠ¡æ•°æ®å¯¼å…¥çš„åŠŸèƒ½ã€‚"><link data-react-helmet="true" rel="icon" href="/intellisense-form-website/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://sinoui.github.io/intellisense-form-website/docs/sinoform-import"><link data-react-helmet="true" rel="alternate" href="https://sinoui.github.io/intellisense-form-website/docs/sinoform-import" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://sinoui.github.io/intellisense-form-website/docs/sinoform-import" hreflang="x-default"><link rel="stylesheet" href="/intellisense-form-website/assets/css/styles.200426ba.css">
<link rel="preload" href="/intellisense-form-website/assets/js/runtime~main.447af4dd.js" as="script">
<link rel="preload" href="/intellisense-form-website/assets/js/main.08a573a6.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/intellisense-form-website/"><div class="navbar__logo"><img src="/intellisense-form-website/img/home/logo.png" alt="æ™ºèƒ½è¡¨å•" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/intellisense-form-website/img/home/logo.png" alt="æ™ºèƒ½è¡¨å•" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">æ™ºèƒ½è¡¨å•</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/intellisense-form-website/docs">æ–‡æ¡£</a></div><div class="navbar__items navbar__items--right"><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">ğŸŒœ</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">ğŸŒ</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/intellisense-form-website/docs/">ä»‹ç»</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/intellisense-form-website/docs/download">ä¸‹è½½å®‰è£…åŒ…</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/intellisense-form-website/docs/deployment">éƒ¨ç½²</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_2fq0" href="/intellisense-form-website/docs/config-custom">åº”ç”¨ç¨‹åºé…ç½®</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/config-custom">é¡¹ç›®ç»„è‡ªå®šä¹‰é…ç½®</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/config-disable-modules">ç¦ç”¨åŠŸèƒ½æ¨¡å—</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/config-data-perm">æ•°æ®æƒé™é…ç½®</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/config-resource-publish">èµ„æºå‘å¸ƒé…ç½®</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/config-workflow">æµç¨‹é…ç½®</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/config-audit">ç³»ç»Ÿç®¡ç†æ—¥å¿—åŠŸèƒ½é›†æˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/config-version">æŸ¥çœ‹äº§å“ç‰ˆæœ¬</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/config-external-intro">å¤–éƒ¨é…ç½®</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/config-remove-test-data">æ¸…é™¤æµ‹è¯•è¡¨å•</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/config-move-form-to-application">åº”ç”¨ä¸‹èµ„æºè¿ç§»</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/config-user-info">ç”¨æˆ·ä¿¡æ¯</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/nginx-location">nginxçš„locationåŒ¹é…è§„åˆ™</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/config-license">License è¯ä¹¦é…ç½®</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/config-file-store">æ–‡ä»¶å­˜å‚¨å®šåˆ¶</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/sinofrom-sinomatrix-import-export">æ™ºèƒ½è¡¨å•é…ç½®æ•°æ®æ•´ä½“è¿ç§»</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/intellisense-form-website/docs/sinoform-import">ä¸šåŠ¡æ•°æ®å¯¼å…¥</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/config-file-online-preview">é™„ä»¶é¢„è§ˆåŠŸèƒ½</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/config-cas-login">CAS å•ç‚¹ç™»å½•é›†æˆé…ç½®</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/config-oauth2-login">OAuth2å•ç‚¹ç™»å½•é›†æˆé…ç½®</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/config-dashboard-engine">ä»ªè¡¨ç›˜ç»Ÿè®¡å¼•æ“é…ç½®</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/intellisense-form-website/docs/plugin-index">æ’ä»¶å¼€å‘</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/intellisense-form-website/docs/custom-css-pc">æ ·å¼å®šåˆ¶</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/intellisense-form-website/docs/sinoform-sdk-event-starter">æ‰©å±•</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/intellisense-form-website/docs/deployment-faq">å¸¸è§é—®é¢˜</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/intellisense-form-website/docs/changelog/changelog-v1.18.11">ç‰ˆæœ¬å˜æ›´è®°å½•</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/intellisense-form-website/docs/custom-print-template">è¡¨å•é…ç½®æ•™ç¨‹</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/intellisense-form-website/docs/performance-test">æ€§èƒ½æµ‹è¯•</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/intellisense-form-website/docs/mobile/detail-page">ç§»åŠ¨ç«¯é›†æˆ</a></div></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>ä¸šåŠ¡æ•°æ®å¯¼å…¥</h1></header><p>ä¸šåŠ¡æ•°æ®å¯¼å…¥åŠŸèƒ½æ˜¯é€šè¿‡è¯»å– excel æ–‡ä»¶æ¥æ‰¹é‡ç”Ÿæˆæˆ–æ›´æ–°è¡¨å•æ•°æ®ã€‚<code>@sinoform/helper-import-excel</code>æ¨¡å—æä¾›äº†ä¸€æ•´å¥— excel è§£æã€æ•°æ®å¤„ç†ã€ä¸šåŠ¡æ•°æ®å¯¼å…¥çš„åŠŸèƒ½ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹<code>@sinoform/helper-import-excel</code>æ¨¡å—çš„æ–¹æ³•ï¼Œç„¶ååˆ†å‡ ä¸ªåœºæ™¯æ¥æ¼”ç¤ºå¦‚ä½•å¯¼å…¥ä¸šåŠ¡æ•°æ®ã€‚</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="sinoformhelper-import-excel-æ¨¡å—">@sinoform/helper-import-excel æ¨¡å—<a class="hash-link" href="#sinoformhelper-import-excel-æ¨¡å—" title="Direct link to heading">â€‹</a></h2><p><code>@sinoform/helper-import-excel</code> æ¨¡å—æä¾›äº†<code>parseImportExcel</code>ã€<code>transformExcelColumns</code>ã€<code>importDataList</code>å‡ ä¸ªæ–¹æ³•æ¥åˆ†åˆ«å®ç° excel è§£æã€æ•°æ®å¤„ç†ã€ä¸šåŠ¡æ•°æ®å¯¼å…¥çš„åŠŸèƒ½ã€‚</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="parseimportexcel">parseImportExcel<a class="hash-link" href="#parseimportexcel" title="Direct link to heading">â€‹</a></h3><p>è§£æ excel å¹¶ç”Ÿæˆ<code>dataList</code>ï¼ˆåˆ—è¡¨æ•°æ®ï¼‰å’Œ<code>columns</code>ï¼ˆè¡¨å¤´ä¿¡æ¯ï¼‰ã€‚æ­¤æ–¹æ³•æ¥å—å¦‚ä¸‹å‡ ä¸ªå‚æ•°ï¼š</p><ul><li>fileã€‚ è¦è§£æçš„ Excel æ–‡ä»¶ï¼Œæ–‡ä»¶ Blob å¯¹è±¡</li><li>formDesignã€‚ è¡¨å•è®¾è®¡é…ç½®ä¿¡æ¯ã€‚excel è§£ææ˜¯é€šè¿‡è¡¨å¤´ä¸è¡¨å•é¡¹é…ç½®ä¸­çš„ title å¯¹åº”æ¥åŒ¹é…è¯¥åˆ—æ˜¯ä»€ä¹ˆå­—æ®µ</li><li>isDataInOneSheetã€‚ ä¸»è¡¨å•å’Œå­è¡¨å•æ•°æ®æ˜¯å¦åœ¨ä¸€ä¸ª sheet é¡µä¸­ã€‚é»˜è®¤ä¸º true</li><li>titleRowã€‚ ä¸»è¡¨å•æ‰€åœ¨ sheet é¡µä¸­çš„æ ‡é¢˜æ‰€åœ¨è¡Œã€‚é»˜è®¤ä¸º 1ï¼ˆexcel ä¸­ç¬¬ä¸€è¡Œä¸º 1ï¼‰</li></ul><p>æ­¤æ–¹æ³•å¯ä»¥å¤„ç† <a href="#excel-%E8%A7%A3%E6%9E%90%E5%9C%BA%E6%99%AF">excel-è§£æåœºæ™¯</a> ä¸­çš„ excel æ•°æ®ï¼Œå¹¶é€šè¿‡ isDataInOneSheet æ¥åˆ¤æ–­åº”è¯¥æ¥ä½¿ç”¨ä½•ç§æ–¹å¼æ¥è§£ææ•°æ®ã€‚å…¶ä¸­åœºæ™¯ä¸€ isDataInOneSheet ä¸º falseï¼Œå…¶ä½™çš„ä¸¤ä¸ªåœºæ™¯å‡ä¸º true</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="transformexcelcolumns">transformExcelColumns<a class="hash-link" href="#transformexcelcolumns" title="Direct link to heading">â€‹</a></h3><p>å°† dataList ä¸­çš„æ ‡é¢˜è½¬æ¢æˆ fieldNameï¼Œè¿”å›å¤„ç†åçš„ dataListã€‚</p><p>æ­¤æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š</p><ul><li>dataListã€‚ åˆ—è¡¨æ•°æ®</li><li>columnsã€‚ æ ‡é¢˜é…ç½®</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="importdatalist">importDataList<a class="hash-link" href="#importdatalist" title="Direct link to heading">â€‹</a></h3><p>æ‰¹é‡å¯¼å…¥å¤„ç†åçš„ excel æ•°æ®ï¼Œå¦‚æœè¡¨å•æ•°æ®ä¸­å­˜åœ¨ idï¼Œåˆ™æ›´æ–°å¯¹åº”çš„è¡¨å•å€¼ï¼Œå¦åˆ™æ–°å»ºè¡¨å•ã€‚</p><p>æ­¤æ–¹æ³•æ¥å—å¦‚ä¸‹å‚æ•°ï¼š</p><ul><li>dataListã€‚ Excel è§£æåçš„æ•°æ®åˆ—è¡¨</li><li>columnsã€‚ åˆ—è¡¨çš„è¡¨å¤´</li><li>formDesignã€‚ è¡¨å•è®¾è®¡</li><li>currentUserã€‚ å½“å‰ç™»å½•äºº</li></ul><p>é€šè¿‡ä¸Šè¿°æ–¹æ³•è¯´æ˜ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°è¿™å…¶å®æ˜¯å°†å¯¼å…¥çš„ä¸‰ä¸ªæ­¥éª¤å°è£…æˆä¸‰ä¸ªç‹¬ç«‹çš„æ–¹æ³•ï¼Œæ’ä»¶é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦å°†è¿™ä¸‰ä¸ªæ–¹æ³•æŒ‰ç…§é¡ºåºè°ƒç”¨å°±å¯ä»¥å®Œæˆæ•°æ®å¯¼å…¥çš„åŠŸèƒ½ã€‚è¿™æ ·å®ç°è¿˜æœ‰ä¸€ä¸ªå¥½å¤„å°±æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸‰ä¸ªæ–¹æ³•ä¸­é—´æ·»åŠ æˆ‘ä»¬è‡ªå·±çš„æ•°æ®å¤„ç†æ–¹æ³•ï¼Œæ¥æ»¡è¶³ä¸€äº›ç‰¹å®šçš„ä¸šåŠ¡åœºæ™¯æˆ–æ•°æ®å¤„ç†ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬å°†æ¼”ç¤ºå¦‚ä½•åˆ›å»ºä¸€ä¸ªå¯¼å…¥æŒ‰é’®ï¼Œå¹¶å¤„ç†ä¸€äº›ç‰¹æ®Šçš„ä¸šåŠ¡åœºæ™¯</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="å¦‚ä½•åˆ›å»ºå®šåˆ¶å¯¼å…¥æŒ‰é’®">å¦‚ä½•åˆ›å»ºå®šåˆ¶å¯¼å…¥æŒ‰é’®<a class="hash-link" href="#å¦‚ä½•åˆ›å»ºå®šåˆ¶å¯¼å…¥æŒ‰é’®" title="Direct link to heading">â€‹</a></h2><ol><li>æ–°å»ºå®šåˆ¶å¯¼å…¥æŒ‰é’®</li></ol><div class="codeBlockContainer_K1bP language-typescript theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">src/plugins/custom-import-button/index.tsx</div><div class="codeBlockContent_hGly typescript"><pre tabindex="0" class="prism-code language-typescript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> useApp</span><span class="token imports punctuation" style="color:#393A34">,</span><span class="token imports"> useFormApp </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@sinoform/app-core&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"></span><br></span><span class="token-line" style="color:#393A34"><span class="token imports">  parseImportExcel</span><span class="token imports punctuation" style="color:#393A34">,</span><span class="token imports"></span><br></span><span class="token-line" style="color:#393A34"><span class="token imports">  transformExcelColumns</span><span class="token imports punctuation" style="color:#393A34">,</span><span class="token imports"></span><br></span><span class="token-line" style="color:#393A34"><span class="token imports">  importDataList</span><span class="token imports punctuation" style="color:#393A34">,</span><span class="token imports"></span><br></span><span class="token-line" style="color:#393A34"><span class="token imports"></span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@sinoform/helper-import-excel&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">Button</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@sinoui/core/Button&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">React</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;react&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">default</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">ImportExcelButton</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> formDesignSetting </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useFormApp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> currentUser </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useApp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">handleChange</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">target</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">files</span><span class="token operator" style="color:#393A34">?.</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> dataList</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> columns </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parseImportExcel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      formDesignSetting</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">transformExcelColumns</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dataList</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> columns</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">importDataList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> columns</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> formDesign</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> userInfo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">input</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      type</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;file&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      accept</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      onChange</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">handleChange</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol start="2"><li>åœ¨åˆ—è¡¨é¡µä¸­æ·»åŠ å¯¼å…¥æŒ‰é’®</li></ol><div class="codeBlockContainer_K1bP language-typescript theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">src/index.ts</div><div class="codeBlockContent_hGly typescript"><pre tabindex="0" class="prism-code language-typescript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports">appSetting</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@sinoform/app-setting&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">React</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;react&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">appSetting</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">listPageConfig</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addButton</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;DRAFT_LIST_PAGE&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  formId</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;XXX&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// éœ€è¦æ›¿æ¢æˆçœŸå®çš„è¡¨å•è®¾è®¡idï¼Œæ­¤å¤„xxxä»£æŒ‡ä»»æ„id</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  render</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">lazy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">import</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;src/plugins/custom-import-button&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pos</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;right&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function-variable function" style="color:#d73a49">availability</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>è¿™æ ·ç®€å•å‡ è¡Œä»£ç ï¼Œæˆ‘ä»¬å°±ä¸ºè¡¨å• id ä¸º&#x27;XXXX&#x27;çš„è‰ç¨¿é¡µæ·»åŠ äº†ä¸€ä¸ªå¯¼å…¥æŒ‰é’®ã€‚</p><p>ä½†æ˜¯æœ‰äº›åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å°±éœ€è¦å¯¹å¯¼å…¥çš„æ•°æ®è¿›è¡Œä¸€å®šçš„å¤„ç†ã€‚æ¯”å¦‚ä¸‹æ–¹è¿™å¼  excel è¡¨ä¸­çš„æ•°æ®ï¼š</p><p><img src="/intellisense-form-website/assets/images/parse-import-column-b8bd39801aee23af2567ec2e2176ca3d.png"></p><p>è¿™ä¸ª excel æ•°æ®ä¸­æœ‰ä¸¤å¤„åœ°æ–¹éœ€è¦æˆ‘ä»¬å¤„ç†ï¼š</p><ul><li>æ•°æ®ä»¥é£é™©äº‹ä»¶è¯´æ˜ã€é£é™©ç¼–å·åˆ—ä¸ºå‡†ï¼Œéœ€è¦è¯¥åˆ—åˆ é™¤ç©ºç™½çš„è¡Œï¼Œå¹¶å°†ä¸šåŠ¡/ç®¡ç†æ¡çº¿ã€ä¸šåŠ¡æ´»åŠ¨/ç®¡ç†é¢†åŸŸã€ä¸šåŠ¡/ç®¡ç†æµç¨‹è¿™äº›æ•°æ®éœ€è¦è¡¥å……åˆ°å¯¹åº”è¡Œä¸­</li><li>é£é™©ç¼–å·å¯¹åº”çš„æ˜¯ä¸¤ä¸ªå­—æ®µï¼Œä¸”ä¸¤ä¸ªå­—æ®µä»¥ç©ºæ ¼åˆ†å¼€</li></ul><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ”¹é€ ä¸€ä¸‹<code>handleChange</code>æ–¹æ³•ï¼Œä»¥æ»¡è¶³æ•°æ®çš„è¦æ±‚</p><div class="codeBlockContainer_K1bP language-typescript theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">src/plugins/custom-import-button/index.tsx</div><div class="codeBlockContent_hGly typescript"><pre tabindex="0" class="prism-code language-typescript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * æ•°æ®è½¬æ¢æ–¹æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">transformDataList</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dataList</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">any</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">A</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">B</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">C</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 1. å¤„ç†Aã€Bã€Cä¸‰åˆ—æ•°æ®ï¼Œè¿‡æ»¤Dã€Eåˆ—çš„ç©ºç™½æ•°æ®</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> filterDatas </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dataList</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token constant" style="color:#36acaa">A</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> item</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">A</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">A</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token constant" style="color:#36acaa">B</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> item</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">B</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">B</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token constant" style="color:#36acaa">C</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> item</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">C</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">C</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">D</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token constant" style="color:#36acaa">A</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token constant" style="color:#36acaa">B</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token constant" style="color:#36acaa">C</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword nil" style="color:#00009f">undefined</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">filter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">Boolean</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 2. æ‹†åˆ†Eåˆ—ï¼Œå¹¶å°†æ‹†åˆ†åçš„æ•°æ®ç›´æ¥èµ‹å€¼ç»™å¯¹åº”çš„è¡¨å•é¡¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> ans </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> filterData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">E</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">field_10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> field_11</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> item</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">E</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa"> +</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        field_10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        field_11</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> item</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> ans</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">handleChange</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">target</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">files</span><span class="token operator" style="color:#393A34">?.</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> dataList</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> columns </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parseImportExcel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> formDesignSetting</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  dataList </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">transformDataList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dataList</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">transformExcelColumns</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dataList</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> columns</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">importDataList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> columns</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> formDesign</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> userInfo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="excel-è§£æåœºæ™¯">excel è§£æåœºæ™¯<a class="hash-link" href="#excel-è§£æåœºæ™¯" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_31ik" id="åœºæ™¯ä¸€ä¸»è¡¨å•æ•°æ®ä¸å­è¡¨å•æ•°æ®åœ¨ä¸åŒçš„-sheet-é¡µä¸­">åœºæ™¯ä¸€ï¼šä¸»è¡¨å•æ•°æ®ä¸å­è¡¨å•æ•°æ®åœ¨ä¸åŒçš„ sheet é¡µä¸­<a class="hash-link" href="#åœºæ™¯ä¸€ä¸»è¡¨å•æ•°æ®ä¸å­è¡¨å•æ•°æ®åœ¨ä¸åŒçš„-sheet-é¡µä¸­" title="Direct link to heading">â€‹</a></h3><p>ä¸»è¡¨å•æ•°æ® sheet é¡µï¼š
<img src="/intellisense-form-website/assets/images/import-excel-type-1_main-7f7c2d7ae0be4d786cc257911fe7eee2.png"></p><p>å­è¡¨å•æ•°æ® sheet é¡µï¼š
<img src="/intellisense-form-website/assets/images/import-excel-type-1_subform-5b2a35bc459b091c5289d8e7e3d4eb63.png"></p><p>è¿™ç§åœºæ™¯ä¸­ï¼Œä¸ºäº†ä¿è¯å­è¡¨å•æ•°æ®èƒ½ä¸ä¸»è¡¨å•æ•°æ®å¯¹åº”çš„èµ·æ¥ï¼Œéœ€è¦å¯¹ excel æ¨¡æ¿åšä¸€äº›é™å®šï¼š</p><ul><li>ç¬¬ä¸€ä¸ª sheet é¡µä¸ºä¸»è¡¨å•æ•°æ®ï¼Œ æ¯ä¸€è¡Œä»£è¡¨ä¸€æ¡è¡¨å•æ•°æ®ï¼Œå…¶ä»– sheet é¡µä¸ºå­è¡¨å•æ•°æ®é¡µã€‚</li><li>ç¬¬ä¸€ä¸ª sheet é¡µçš„ç¬¬ä¸€åˆ—å¿…é¡»æ˜¯æ•°æ®çš„ç¼–å·ï¼Œæ­¤ç¼–å·å¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚</li><li>å­è¡¨å•æ•°æ® sheet é¡µçš„åç§°å¿…é¡»ä¸è¡¨å•è®¾è®¡ä¸­çš„å­è¡¨å•é¡¹åç§°ä¸€è‡´ã€‚</li><li>å­è¡¨å•æ•°æ® sheet é¡µçš„ç¬¬ä¸€åˆ—å¿…é¡»æ˜¯æ‰€å±ä¸»è¡¨å•çš„ç¼–å·ï¼Œç”¨äºè¡¨ç¤ºè¯¥æ¡å­è¡¨å•æ•°æ®å±äºå“ªä¸€æ¡ä¸»è¡¨å•æ•°æ®ã€‚</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="åœºæ™¯äºŒä¸»è¡¨å•ä¸å­è¡¨å•åœ¨åŒä¸€ä¸ª-sheet-é¡µä¸­å­è¡¨å•é¡¹çš„å€¼åœ¨ä¸€åˆ—ä¸­ä»¥é€—å·åˆ†å¼€">åœºæ™¯äºŒï¼šä¸»è¡¨å•ä¸å­è¡¨å•åœ¨åŒä¸€ä¸ª sheet é¡µä¸­ï¼Œå­è¡¨å•é¡¹çš„å€¼åœ¨ä¸€åˆ—ä¸­ï¼Œä»¥é€—å·åˆ†å¼€<a class="hash-link" href="#åœºæ™¯äºŒä¸»è¡¨å•ä¸å­è¡¨å•åœ¨åŒä¸€ä¸ª-sheet-é¡µä¸­å­è¡¨å•é¡¹çš„å€¼åœ¨ä¸€åˆ—ä¸­ä»¥é€—å·åˆ†å¼€" title="Direct link to heading">â€‹</a></h3><p><img src="/intellisense-form-website/assets/images/import-excel-type-2-afe35bd8ea682b695d45aabc78af16fd.png"></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="åœºæ™¯ä¸‰ä¸»è¡¨å•ä¸å­è¡¨å•åœ¨åŒä¸€ä¸ª-sheet-é¡µä¸­å­è¡¨å•æ•°æ®åœ¨æ•°æ®è¡Œå¹³é“ºå»¶å±•">åœºæ™¯ä¸‰ï¼šä¸»è¡¨å•ä¸å­è¡¨å•åœ¨åŒä¸€ä¸ª sheet é¡µä¸­ï¼Œå­è¡¨å•æ•°æ®åœ¨æ•°æ®è¡Œå¹³é“ºå»¶å±•<a class="hash-link" href="#åœºæ™¯ä¸‰ä¸»è¡¨å•ä¸å­è¡¨å•åœ¨åŒä¸€ä¸ª-sheet-é¡µä¸­å­è¡¨å•æ•°æ®åœ¨æ•°æ®è¡Œå¹³é“ºå»¶å±•" title="Direct link to heading">â€‹</a></h3><p><img src="/intellisense-form-website/assets/images/import-excel-type-3-95da3dd217a36386f0a5eab2a1ad2dee.png"></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/intellisense-form-website/docs/sinofrom-sinomatrix-import-export"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">æ™ºèƒ½è¡¨å•é…ç½®æ•°æ®æ•´ä½“è¿ç§»</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/intellisense-form-website/docs/config-file-online-preview"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">é™„ä»¶é¢„è§ˆåŠŸèƒ½</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#sinoformhelper-import-excel-æ¨¡å—" class="table-of-contents__link toc-highlight">@sinoform/helper-import-excel æ¨¡å—</a><ul><li><a href="#parseimportexcel" class="table-of-contents__link toc-highlight">parseImportExcel</a></li><li><a href="#transformexcelcolumns" class="table-of-contents__link toc-highlight">transformExcelColumns</a></li><li><a href="#importdatalist" class="table-of-contents__link toc-highlight">importDataList</a></li></ul></li><li><a href="#å¦‚ä½•åˆ›å»ºå®šåˆ¶å¯¼å…¥æŒ‰é’®" class="table-of-contents__link toc-highlight">å¦‚ä½•åˆ›å»ºå®šåˆ¶å¯¼å…¥æŒ‰é’®</a></li><li><a href="#excel-è§£æåœºæ™¯" class="table-of-contents__link toc-highlight">excel è§£æåœºæ™¯</a><ul><li><a href="#åœºæ™¯ä¸€ä¸»è¡¨å•æ•°æ®ä¸å­è¡¨å•æ•°æ®åœ¨ä¸åŒçš„-sheet-é¡µä¸­" class="table-of-contents__link toc-highlight">åœºæ™¯ä¸€ï¼šä¸»è¡¨å•æ•°æ®ä¸å­è¡¨å•æ•°æ®åœ¨ä¸åŒçš„ sheet é¡µä¸­</a></li><li><a href="#åœºæ™¯äºŒä¸»è¡¨å•ä¸å­è¡¨å•åœ¨åŒä¸€ä¸ª-sheet-é¡µä¸­å­è¡¨å•é¡¹çš„å€¼åœ¨ä¸€åˆ—ä¸­ä»¥é€—å·åˆ†å¼€" class="table-of-contents__link toc-highlight">åœºæ™¯äºŒï¼šä¸»è¡¨å•ä¸å­è¡¨å•åœ¨åŒä¸€ä¸ª sheet é¡µä¸­ï¼Œå­è¡¨å•é¡¹çš„å€¼åœ¨ä¸€åˆ—ä¸­ï¼Œä»¥é€—å·åˆ†å¼€</a></li><li><a href="#åœºæ™¯ä¸‰ä¸»è¡¨å•ä¸å­è¡¨å•åœ¨åŒä¸€ä¸ª-sheet-é¡µä¸­å­è¡¨å•æ•°æ®åœ¨æ•°æ®è¡Œå¹³é“ºå»¶å±•" class="table-of-contents__link toc-highlight">åœºæ™¯ä¸‰ï¼šä¸»è¡¨å•ä¸å­è¡¨å•åœ¨åŒä¸€ä¸ª sheet é¡µä¸­ï¼Œå­è¡¨å•æ•°æ®åœ¨æ•°æ®è¡Œå¹³é“ºå»¶å±•</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/intellisense-form-website/assets/js/runtime~main.447af4dd.js"></script>
<script src="/intellisense-form-website/assets/js/main.08a573a6.js"></script>
</body>
</html>