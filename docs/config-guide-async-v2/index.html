<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<title data-react-helmet="true">关联其他表单数据v2 | intellisense-form</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://sinoui.github.io/intellisense-form-website/docs/config-guide-async-v2"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="关联其他表单数据v2 | intellisense-form"><meta data-react-helmet="true" name="description" content="支持版本：1.18.10"><meta data-react-helmet="true" property="og:description" content="支持版本：1.18.10"><link data-react-helmet="true" rel="icon" href="/intellisense-form-website/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://sinoui.github.io/intellisense-form-website/docs/config-guide-async-v2"><link data-react-helmet="true" rel="alternate" href="https://sinoui.github.io/intellisense-form-website/docs/config-guide-async-v2" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://sinoui.github.io/intellisense-form-website/docs/config-guide-async-v2" hreflang="x-default"><link rel="stylesheet" href="/intellisense-form-website/assets/css/styles.200426ba.css">
<link rel="preload" href="/intellisense-form-website/assets/js/runtime~main.447af4dd.js" as="script">
<link rel="preload" href="/intellisense-form-website/assets/js/main.08a573a6.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/intellisense-form-website/"><div class="navbar__logo"><img src="/intellisense-form-website/img/home/logo.png" alt="智能表单" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/intellisense-form-website/img/home/logo.png" alt="智能表单" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">智能表单</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/intellisense-form-website/docs">文档</a></div><div class="navbar__items navbar__items--right"><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">🌜</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">🌞</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/intellisense-form-website/docs/">介绍</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/intellisense-form-website/docs/download">下载安装包</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/intellisense-form-website/docs/deployment">部署</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/intellisense-form-website/docs/config-custom">应用程序配置</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/intellisense-form-website/docs/plugin-index">插件开发</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/intellisense-form-website/docs/custom-css-pc">样式定制</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/intellisense-form-website/docs/sinoform-sdk-event-starter">扩展</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/intellisense-form-website/docs/deployment-faq">常见问题</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/intellisense-form-website/docs/changelog/changelog-v1.18.11">版本变更记录</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_2fq0" href="/intellisense-form-website/docs/custom-print-template">表单配置教程</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/custom-print-template">在线自定义打印模板</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/custom-form-app">单独使用表单应用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/todo-integrate">待办详情页集成</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/custom-icon-for-app">应用图标定制</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/expression-rules">公式规则</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/interpolation-expression">插值表达式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/custom-list-guide">列表定制手册</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/export-excel">定制导出excel按钮</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/dictionary-manager">数据字典管理员</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/guide-list-page-columns-config">列表页展示项定制</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/guide-list-page-transform-data">定制列表数据转换</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/extra-field">扩展字段</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/app-role-manager">应用角色授权</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/config-auto-rely">自动关联</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/intellisense-form-website/docs/config-guide-async-v2">关联其他表单数据v2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intellisense-form-website/docs/config-guide-form-events">监听表单事件</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/intellisense-form-website/docs/performance-test">性能测试</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/intellisense-form-website/docs/mobile/detail-page">移动端集成</a></div></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>关联其他表单数据v2</h1></header><blockquote><p>支持版本：1.18.10</p></blockquote><p>下拉选择框、单选按钮组、多选按钮组表单项组件的“选项类型”新增“关联其他表单数据
v2”方式，此方式允许定义其他表单的数据作为选项清单，且可以通过 JavaScript 定义关
联表单（其他表单）数据的过滤条件和值映射规则（将选中的关联表单数据映射到当前表单
其他字段中）。</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="1-基本使用">1. 基本使用<a class="hash-link" href="#1-基本使用" title="Direct link to heading">​</a></h2><p>“选项类型”中选择<strong>关联其他表单数据 v2</strong>，并选择<strong>关联的表单</strong>和<strong>关联的表单字
段</strong>，如下图所示：</p><p><img src="/intellisense-form-website/assets/images/async-v2-1-c515573d8675fa1d5351be5f019ab4ce.png"></p><p>示例中选择了<strong>内部验证/人员信息登记</strong>表单和<strong>姓名</strong>字段。那么就会将<strong>内部验证/人
员信息登记</strong>表单中所有的数据查询出来，并将<strong>姓名</strong>字段值作为选项提供给<strong>下拉选
择</strong>组件，实际效果如下图所示：</p><p><img src="/intellisense-form-website/assets/images/async-v2-1-preview-b5d1c75e2d20ca161ff5b45ee1f8cc5e.png"></p><blockquote><p>注意：只能选择应用中的表单作为关联表单。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_31ik" id="2-设置过滤条件">2. 设置过滤条件<a class="hash-link" href="#2-设置过滤条件" title="Direct link to heading">​</a></h2><p>默认情况下会查询出关联表单所有数据（选项清单限制为 100 条），我们可以<strong>设置数据
过滤条件</strong>，有选择性地返回关联表单数据。</p><p>例如：我们只要年龄（<code>field_2</code>字段）大于等于 30 岁的数据，做如下图的设置：</p><p><img src="/intellisense-form-website/assets/images/async-v2-filter-1b5fb5ac5bc1046a6fe9f42555ab4ff2.png"></p><p>设置条件为：</p><div class="codeBlockContainer_K1bP language-typescript theme-code-block"><div class="codeBlockContent_hGly typescript"><pre tabindex="0" class="prism-code language-typescript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">$</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;field_2&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">gte</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">30</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>那么实际的效果如下图所示：</p><p><img src="/intellisense-form-website/assets/images/async-v2-filter-preview-2b34e813c3ccd1b2736eab37feeec2c3.png"></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="21-去哪里找到关联表单有哪些字段">2.1. 去哪里找到关联表单有哪些字段？<a class="hash-link" href="#21-去哪里找到关联表单有哪些字段" title="Direct link to heading">​</a></h3><p>为了方便在编写查询条件时查找关联表单有哪些字段，将关联表单值类型接口放在代码编辑
器的底部，如果不清楚关联表单有哪些字段，可以从这个接口声明中查找一下，如下图所示
：</p><p><img src="/intellisense-form-website/assets/images/async-v2-filter-relation-form-interface-ecb612b617e5a7ecb365b4c3bf4eb322.png"></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="22-设置数据过滤条件的语法">2.2. 设置数据过滤条件的语法<a class="hash-link" href="#22-设置数据过滤条件的语法" title="Direct link to heading">​</a></h3><p>过滤条件设置语法的完整教程
：<a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#%E6%94%AF%E6%8C%81%E7%9A%84%E6%93%8D%E4%BD%9C%E7%AC%A6" target="_blank" rel="noopener noreferrer">@sinoform/helper-condition-api</a></p><p>支持两种风格 API，设置过滤条件，即：</p><p>第一种风格：</p><div class="codeBlockContainer_K1bP language-typescript theme-code-block"><div class="codeBlockContent_hGly typescript"><pre tabindex="0" class="prism-code language-typescript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">$</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;field_1&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">gte</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">30</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>第二种风格：</p><div class="codeBlockContainer_K1bP language-typescript theme-code-block"><div class="codeBlockContent_hGly typescript"><pre tabindex="0" class="prism-code language-typescript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">sql</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">field_1 &gt;= 30</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>根据个人喜选择 API 风格。推荐采用第一种风格。本教程采用第一种风格做说明。</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="23-支持的操作符">2.3. 支持的操作符<a class="hash-link" href="#23-支持的操作符" title="Direct link to heading">​</a></h3><p>支持的操作符分成三类：</p><ul><li>单个字段的操作符，
如<a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#gte" target="_blank" rel="noopener noreferrer">gte</a>、<a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#contain" target="_blank" rel="noopener noreferrer">contain</a>、<a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#equal" target="_blank" rel="noopener noreferrer">equal</a>等
。</li><li>组合查询条件的逻辑操作符，
如<a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#and" target="_blank" rel="noopener noreferrer">and</a>、<a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#or" target="_blank" rel="noopener noreferrer">or</a>、<a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#not" target="_blank" rel="noopener noreferrer">not</a>。</li><li>扩展操作符，如查询仅当前登录用户有权限看到的数据
<a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#queryselfall" target="_blank" rel="noopener noreferrer">querySelfAll</a>、
查询仅当前登录用户所在部门有权限看到的数据
<a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#querydeptall" target="_blank" rel="noopener noreferrer">queryDeptAll</a>。</li></ul><p>支持的操作符如下表所示：</p><table><thead><tr><th>操作符</th><th>说明</th></tr></thead><tbody><tr><td><a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#equal" target="_blank" rel="noopener noreferrer">equal</a></td><td>相等比较操作符</td></tr><tr><td><a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#notEqual" target="_blank" rel="noopener noreferrer">notEqual</a></td><td>不相等比较操作符</td></tr><tr><td><a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#contain" target="_blank" rel="noopener noreferrer">contain</a></td><td>文本包含操作符，相当于 <code>like &#x27;%文本%&#x27;</code></td></tr><tr><td><a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#notContain" target="_blank" rel="noopener noreferrer">notContain</a></td><td>文本不包含操作符</td></tr><tr><td><a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#isNull" target="_blank" rel="noopener noreferrer">isNull</a></td><td>空判定操作符</td></tr><tr><td><a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#notNull" target="_blank" rel="noopener noreferrer">notNull</a></td><td>非空判定操作符</td></tr><tr><td><a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#lt" target="_blank" rel="noopener noreferrer">lt</a></td><td>小于操作符</td></tr><tr><td><a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#gt" target="_blank" rel="noopener noreferrer">gt</a></td><td>大于操作符</td></tr><tr><td><a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#lte" target="_blank" rel="noopener noreferrer">lte</a></td><td>小于等于操作符</td></tr><tr><td><a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#gte" target="_blank" rel="noopener noreferrer">gte</a></td><td>大于等于操作符</td></tr><tr><td><a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#in" target="_blank" rel="noopener noreferrer">in</a></td><td>包含操作符</td></tr><tr><td><a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#is" target="_blank" rel="noopener noreferrer">is</a></td><td><code>is null</code>场景中使用的操作符</td></tr><tr><td><a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#isNot" target="_blank" rel="noopener noreferrer">isNot</a></td><td><code>is not null</code> 场景使用的操作符</td></tr><tr><td><a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#like" target="_blank" rel="noopener noreferrer">like</a></td><td>文本包含操作符</td></tr><tr><td><a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#notLike" target="_blank" rel="noopener noreferrer">notLike</a></td><td>文本不包含操作符</td></tr><tr><td><a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#range" target="_blank" rel="noopener noreferrer">range</a></td><td>区间操作符，相当于 <code>between x and y</code></td></tr><tr><td><a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#and" target="_blank" rel="noopener noreferrer">and</a></td><td>并且逻辑操作符，使用 <code>and</code> 组合的多个查询条件是必须都要满足的</td></tr><tr><td><a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#or" target="_blank" rel="noopener noreferrer">or</a></td><td>或者逻辑操作符，使用 <code>or</code> 组合的多个查询条件只需要满足一个即可</td></tr><tr><td><a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#not" target="_blank" rel="noopener noreferrer">not</a></td><td>非逻辑操作符，使用 <code>not</code> 包裹的查询条件表示查询不满足此查询条件的数据</td></tr><tr><td><a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#querySelfAll" target="_blank" rel="noopener noreferrer">querySelfAll</a></td><td>仅查询出自己可见的所有数据</td></tr><tr><td><a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#queryDeptAll" target="_blank" rel="noopener noreferrer">queryDeptAll</a></td><td>查询出自己和部门可见的所有数据</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_31ik" id="24-添加权限过滤条件">2.4. 添加权限过滤条件<a class="hash-link" href="#24-添加权限过滤条件" title="Direct link to heading">​</a></h3><p>默认情况下会查询出关联表单所有数据。上个章节介绍了两个权限相关的操作符，即：</p><ul><li><a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#querySelfAll" target="_blank" rel="noopener noreferrer">querySelfAll</a> -
仅查询出当前登录用户可见的所有数据</li><li><a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#queryDeptAll" target="_blank" rel="noopener noreferrer">queryDeptAll</a> -
查询出当前登录用户和所属部门可见的所有数据</li></ul><p><a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#querySelfAll" target="_blank" rel="noopener noreferrer">querySelfAll</a>
操作符会限定仅仅出现由当前登录用户创建的或者当前用户办理过的表单数据。</p><p><a href="https://www.npmjs.com/package/@sinoform/helper-condition-api#queryDeptAll" target="_blank" rel="noopener noreferrer">queryDeptAll</a>
在使用时应指定部门级别（从 0 开始计数，最顶级的部门级别为 0）。例如下面的部门结
构：</p><div class="codeBlockContainer_K1bP language-text theme-code-block"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">xxx集团                           level = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|__ A部门                         level = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |__ A1处室                    level = 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       |__ 张三</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|__ B部门                         level = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |__ 王五</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |__ B2处室                    level = 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      |__ 李四</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>例如下面的查询条件：</p><div class="codeBlockContainer_K1bP language-typescript theme-code-block"><div class="codeBlockContent_hGly typescript"><pre tabindex="0" class="prism-code language-typescript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">queryDeptAll</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>如果是 <code>李四</code> 登录进系统，那么他可以看到 <code>B部门</code> 下所有用户能够看到的数据；如果
是 <code>张三</code> 登录进系统，那么他可以看到 <code>A部门</code> 下所有用户能够看到的数据。</p><p>如果想仅看到自己所在的直属处室/部门的数据，那么可以给一个非常大的部门级别即可：</p><div class="codeBlockContainer_K1bP language-typescript theme-code-block"><div class="codeBlockContent_hGly typescript"><pre tabindex="0" class="prism-code language-typescript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">queryDeptAll</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>该操作符会先查找第 100 级的部门，发现它不存在（一般情况不会存在），那么它就会采
用当前用户直属处室/部门。</p><p>如果这些权限依然不满足，那么可以自行定义权限条件。<code>context</code> 中包含了当前用户信息
和当前表单信息，如下所示：</p><div class="codeBlockContainer_K1bP language-typescript theme-code-block"><div class="codeBlockContent_hGly typescript"><pre tabindex="0" class="prism-code language-typescript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getFilterConditions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  sql</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> sql</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  context</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Context</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">ISqlCondition</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token keyword nil" style="color:#00009f">undefined</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">and</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">$</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;field_1&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">equal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">currentUser</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">deptId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">$</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;field_2&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">equal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">formValues</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">field_10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="25-将当前表单中其他字段的值作为查询条件">2.5. 将当前表单中其他字段的值作为查询条件<a class="hash-link" href="#25-将当前表单中其他字段的值作为查询条件" title="Direct link to heading">​</a></h3><p>可以将当前表单中其他字段的值作为查询条件。当改变了这些字段的值时，会重新查询关联
表单数据。例如：</p><div class="codeBlockContainer_K1bP language-typescript theme-code-block"><div class="codeBlockContent_hGly typescript"><pre tabindex="0" class="prism-code language-typescript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getFilterConditions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  sql</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> sql</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  context</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Context</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">ISqlCondition</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token keyword nil" style="color:#00009f">undefined</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">$</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;field_2&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">equal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">formValues</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">field_4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>示例代码设置了这样的查询条件：关联表单的<code>field_2</code>字段值应等于当前表单
的<code>field_4</code>字段值。</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="3-设置排序规则">3. 设置排序规则<a class="hash-link" href="#3-设置排序规则" title="Direct link to heading">​</a></h2><p>默认不会对关联表单数据做排序，可以设置<strong>关联表单排序字段</strong>和<strong>排序方向</strong>。</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="4-选中关联表单数据时的值映射">4. 选中关联表单数据时的值映射<a class="hash-link" href="#4-选中关联表单数据时的值映射" title="Direct link to heading">​</a></h2><p>如果在选中选项时，要将关联表单数据的字段值填充到当前表单其他字段中，那么需要<strong>设
置选中选项时的值映射</strong>，如下图所示：</p><p><img src="/intellisense-form-website/assets/images/async-v2-mapping-09fc40ae1ef4e53a4f495fbe92fe6836.png"></p><p>其中 <code>current</code> 代表当前表单值，<code>source</code> 代表关联表单的值。</p><p>实际效果如下图所示：</p><p><img src="/intellisense-form-website/assets/images/async-v2-mapping-preview-b2951310e7c2fd23456d352b4100a59c.png"></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="41-关联表单值类型">4.1. 关联表单值类型<a class="hash-link" href="#41-关联表单值类型" title="Direct link to heading">​</a></h3><p>如果是单选按钮组或者单选下拉框，那么 <code>source</code> 的类型是表单值对象，如果是多选按钮
组或者多选下拉框，那么 <code>source</code> 的类型是表单值对象数组（因为表示一组数据）。如下
图所示：</p><p><img src="/intellisense-form-website/assets/images/async-v2-mapping-multiple-40de3807c4b0b8880715d08ec4b469b3.png"></p><p>效果如下图所示：</p><p><img src="/intellisense-form-website/assets/images/async-v2-mapping-multiple-preview-442068156d2751f73df30fc6216c3eeb.png"></p><h2 class="anchor anchorWithStickyNavbar_31ik" id="5-选项去重">5. 选项去重<a class="hash-link" href="#5-选项去重" title="Direct link to heading">​</a></h2><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>注意：<strong>选项去重</strong>与<strong>设置选中选项时的值映射</strong>是互斥的特性，二者只能同时启用一个
。</p></div></div><p>如果需要去掉重复的选项，可以启用 <strong>去掉重复值</strong>。</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/intellisense-form-website/docs/config-auto-rely"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">自动关联</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/intellisense-form-website/docs/config-guide-form-events"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">监听表单事件</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-基本使用" class="table-of-contents__link toc-highlight">1. 基本使用</a></li><li><a href="#2-设置过滤条件" class="table-of-contents__link toc-highlight">2. 设置过滤条件</a><ul><li><a href="#21-去哪里找到关联表单有哪些字段" class="table-of-contents__link toc-highlight">2.1. 去哪里找到关联表单有哪些字段？</a></li><li><a href="#22-设置数据过滤条件的语法" class="table-of-contents__link toc-highlight">2.2. 设置数据过滤条件的语法</a></li><li><a href="#23-支持的操作符" class="table-of-contents__link toc-highlight">2.3. 支持的操作符</a></li><li><a href="#24-添加权限过滤条件" class="table-of-contents__link toc-highlight">2.4. 添加权限过滤条件</a></li><li><a href="#25-将当前表单中其他字段的值作为查询条件" class="table-of-contents__link toc-highlight">2.5. 将当前表单中其他字段的值作为查询条件</a></li></ul></li><li><a href="#3-设置排序规则" class="table-of-contents__link toc-highlight">3. 设置排序规则</a></li><li><a href="#4-选中关联表单数据时的值映射" class="table-of-contents__link toc-highlight">4. 选中关联表单数据时的值映射</a><ul><li><a href="#41-关联表单值类型" class="table-of-contents__link toc-highlight">4.1. 关联表单值类型</a></li></ul></li><li><a href="#5-选项去重" class="table-of-contents__link toc-highlight">5. 选项去重</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/intellisense-form-website/assets/js/runtime~main.447af4dd.js"></script>
<script src="/intellisense-form-website/assets/js/main.08a573a6.js"></script>
</body>
</html>